const CHESS_MANUAL={"7,7":{"6,6":{"8,6":{"7,5":{"6,8":{}},"5,7":{"7,5":{}},"8,5":{"6,8":{}},"7,6":{"6,8":{}},"6,7":{"6,8":{}},"9,5":{"7,8":{}},"6,8":{"8,5":{}},"9,6":{"7,8":{}},"8,7":{"6,8":{}},"7,8":{"6,8":{}},"9,7":{"6,8":{}},"8,8":{"9,7":{}},"5,5":{"8,7":{}},"6,5":{"6,8":{}},"5,6":{"9,7":{}}}},"7,6":{"6,6":{"7,5":{"5,5":{}},"5,7":{"5,5":{}},"8,5":{"6,7":{}},"6,7":{"8,5":{}},"8,6":{"8,8":{}},"6,8":{"8,8":{}},"8,7":{"8,8":{}},"7,8":{"8,8":{}},"8,8":{"6,5":{}},"5,5":{"8,8":{}},"6,5":{"5,5":{}},"5,6":{"5,5":{}}}},"6,7":{"6,6":{"7,5":{"5,5":{}},"5,7":{"5,5":{}},"7,6":{"8,5":{}},"5,8":{"7,6":{}},"8,6":{"8,8":{}},"6,8":{"8,8":{}},"8,7":{"8,8":{}},"7,8":{"8,8":{}},"8,8":{"5,6":{}},"5,5":{"8,8":{}},"6,5":{"5,5":{}},"5,6":{"5,5":{}}}},"8,6":{"6,6":{"7,5":{"8,8":{}},"5,7":{"8,8":{}},"8,5":{"8,8":{}},"7,6":{"8,8":{}},"6,7":{"8,8":{}},"9,5":{"6,7":{}},"6,8":{"5,7":{}},"9,6":{"5,7":{}},"8,7":{"8,8":{}},"7,8":{"8,8":{}},"9,7":{"7,5":{}},"8,8":{"6,5":{}},"5,5":{"7,8":{}},"6,5":{"8,8":{}},"5,6":{"7,8":{}}}},"6,8":{"6,6":{"7,5":{"8,8":{}},"5,7":{"8,8":{}},"7,6":{"8,8":{}},"6,7":{"8,8":{}},"5,8":{"8,8":{}},"8,6":{"5,7":{}},"5,9":{"7,6":{}},"8,7":{"8,8":{}},"7,8":{"8,8":{}},"6,9":{"7,5":{}},"8,8":{"5,6":{}},"7,9":{"5,7":{}},"5,5":{"8,7":{}},"6,5":{"8,7":{}},"5,6":{"8,8":{}}}},"8,7":{"8,6":{"7,5":{"9,5":{}},"6,6":{"6,8":{}},"8,5":{"9,5":{}},"7,6":{"6,5":{}},"6,7":{"6,8":{}},"9,5":{"6,8":{}},"6,8":{"9,6":{}},"9,6":{"9,5":{}},"7,8":{"6,8":{}},"9,7":{"9,5":{}},"8,8":{"6,8":{}},"9,8":{"7,6":{}}}},"7,8":{"6,8":{"6,6":{"8,6":{}},"5,7":{"5,9":{}},"7,6":{"8,6":{}},"6,7":{"5,6":{}},"5,8":{"5,9":{}},"8,6":{"6,9":{}},"5,9":{"8,6":{}},"8,7":{"8,6":{}},"6,9":{"5,9":{}},"8,8":{"8,6":{}},"7,9":{"5,9":{}},"8,9":{"6,7":{}}}},"8,8":{"8,6":{"7,5":{"6,8":{}},"6,6":{"9,7":{}},"8,5":{"6,7":{}},"7,6":{"6,8":{}},"6,7":{"6,8":{}},"9,5":{"6,7":{}},"6,8":{"9,6":{}},"9,6":{"6,8":{}},"8,7":{"6,8":{}},"7,8":{"6,8":{}},"9,7":{"6,8":{}},"7,9":{"9,7":{}},"9,8":{"6,8":{}},"8,9":{"7,5":{}},"9,9":{"7,6":{}}}}}},b2=t=>1<<t+1,sum=t=>{let o=0;return t.forEach((t=>o+=t)),o},INF=b2(19),SHAPE={ooooo:[INF,11],_oooo_:[b2(14),10],oooo_:[b2(9),9],ooo_o:[b2(9),9],oo_oo:[b2(9),9],o_ooo:[b2(9),9],_oooo:[b2(9),9],__ooo__:[b2(9),8],_ooo__:[b2(8),7],_oo_o_:[b2(8),7],_o_oo_:[b2(8),7],ooo__:[b2(7),6],oo_o_:[b2(7),6],oo__o:[b2(7),6],o_oo_:[b2(7),6],o_o_o:[b2(7),6],o__oo:[b2(7),6],_ooo_:[b2(7),6],_oo_o:[b2(7),6],_o_oo:[b2(7),6],__ooo:[b2(7),6],___oo___:[b2(7),5],__oo___:[b2(6),4],__o_o__:[b2(6),4],_oo__:[b2(5),3],__oo_:[b2(5),3],_o_o_:[b2(5)-1,3],oo___:[b2(5)-2,3],o_o__:[b2(5)-2,3],o__o_:[b2(5)-2,3],o___o:[b2(5)-2,3],_o__o:[b2(5)-2,3],__o_o:[b2(5)-2,3],___oo:[b2(5)-2,3],____o____:[b2(5),2],__o__:[b2(3),1],_o___:[b2(3)-1,1],___o_:[b2(3)-1,1],o____:[b2(3)-2,1],____o:[b2(3)-2,1]},create2DArr=(t,o,e)=>{let r=[];for(let i=0;i<o;i++){r[i]=[];for(let o=0;o<t;o++)r[i][o]=e}return r},changeRound=(t,o,e,r)=>{for(let i=-2;i<=2;i++)for(let s=-2;s<=2;s++){let _=o+s,h=e+i;_<0||_>=t[0].length||h<0||h>=t.length||(t[h][_]+=r)}};let DXY=[[1,0],[1,1],[0,1],[-1,1]];const getShapes=(t,o,e,r)=>{if(-1==t[e][o])return[];let i=t[e][o],s=[];for(let _=0;_<4;_++){if(void 0!==r&&_!=r)continue;let h="o";for(let r=1;r<=4;r++){let s=o+r*DXY[_][0],l=e+r*DXY[_][1];if(s<0||s>=t[0].length||l<0||l>=t.length||t[l][s]==1-i)break;t[l][s]==i?h+="o":h+="_"}for(let r=-1;r>=-4;r--){let s=o+r*DXY[_][0],l=e+r*DXY[_][1];if(s<0||s>=t[0].length||l<0||l>=t.length||t[l][s]==1-i)break;h=t[l][s]==i?"o"+h:"_"+h}s[_]=h}return s},getGrade=(t,o,e,r)=>{let i=[0,0,0,0,0];if(-1==t[e][o])return i;let s=getShapes(t,o,e,r);for(let t=0;t<4;t++)if(s[t])for(let o in SHAPE)if(-1!=s[t].indexOf(o)){i[t]=SHAPE[o][0],i[4]+=i[t];break}return i},print=(t,o,e)=>{console.log(e);let r="------------------------\n";r+=`-----------${t}-------------\n`;for(let t=0;t<o.length;t++){for(let i=0;i<o[0].length;i++)r+=(e?e(o[t][i]):o[t][i])+"\t";r+="\n"}console.log(r)},foreach=(t,o)=>{let e=!1;const r=()=>e=!0;for(let i=0;i<t.length;i++)for(let s=0;s<t[0].length;s++)if(o(s,i,t[i][s],r),e)return},BLACK=1,WHITE=0,EMPTY=-1;class Chess{constructor(t,o){if(!t||!t.length||t.length!=t[0].length)throw new Error;this.points=JSON.parse(JSON.stringify(t)),this.w=this.points.length,this.current=o,this.passArea=create2DArr(this.w,this.w,0),this.passArea[Math.floor(this.w/2)][Math.floor(this.w/2)]=1,foreach(this.points,((t,o,e)=>-1!=e&&changeRound(this.passArea,t,o,1))),this.fullGrade=[0,0],this.gradeArea=create2DArr(this.w,this.w,[0,0,0,0,0]),foreach(this.points,((t,o,e)=>{-1!=e&&(this.gradeArea[o][t]=getGrade(this.points,t,o),this.gradeArea[o][t][4]=sum(this.gradeArea[o][t]),this.fullGrade[1]+=(1==e?1:-1)*this.gradeArea[o][t][4],this.fullGrade[0]+=(0==e?1:-1)*this.gradeArea[o][t][4])})),this.cm=CHESS_MANUAL}getPoints(){return JSON.parse(JSON.stringify(this.points))}isWin(t,o){if(-1==this.points[o][t])return!1;for(let e of getShapes(this.points,t,o))if(-1!=e.indexOf("ooooo"))return!0;return!1}updateMiGrade(t,o){for(let e=0;e<4;e++)for(let r=-4;r<=4;r++){if(0==r)continue;let i=t+r*DXY[e][0],s=o+r*DXY[e][1];if(i>=0&&i<this.w&&s>=0&&s<this.w){let t=getGrade(this.points,i,s,e),o=t[e]-this.gradeArea[s][i][e],r=this.points[s][i];this.fullGrade[1]+=(1==r?1:-1)*o,this.fullGrade[0]+=(0==r?1:-1)*o,this.gradeArea[s][i][4]+=o,this.gradeArea[s][i][e]=t[e]}}}putPoint(t,o,e,r){return-1==this.points[o][t]&&(this.points[o][t]=e,changeRound(this.passArea,t,o,1),this.updateMiGrade(t,o),this.gradeArea[o][t]=getGrade(this.points,t,o),this.gradeArea[o][t][4]=sum(this.gradeArea[o][t]),this.fullGrade[1]+=(1==e?1:-1)*this.gradeArea[o][t][4],this.fullGrade[0]+=(0==e?1:-1)*this.gradeArea[o][t][4],this.cm&&(this.cm=this.cm[`${t},${o}`]),!0)}removePoint(t,o){let e=this.points[o][t];this.points[o][t]=-1,changeRound(this.passArea,t,o,-1),this.updateMiGrade(t,o),this.fullGrade[1]+=(1==e?-1:1)*this.gradeArea[o][t][4],this.fullGrade[0]+=(0==e?-1:1)*this.gradeArea[o][t][4],this.gradeArea[o][t]=[0,0,0,0,0]}calc(t,o){if(1==t&&this.cm)for(let t in this.cm){let o=t.split(",");return{x:Number(o[0]),y:Number(o[1])}}return this.subCalc(t,o,null)}subCalc(t,o,e){let r,i=null;for(let s=0;s<this.w;s++)for(let _=0;_<this.w;_++){if(-1!=this.points[s][_]||0==this.passArea[s][_])continue;if(this.putPoint(_,s,t),getGrade(this.points,_,s)[4]>=INF)return this.removePoint(_,s),{x:_,y:s,g:INF};let h=1==o?this.fullGrade[1-t]:this.subCalc(1-t,o-1,null==i?null:-i).g;if(this.removePoint(_,s),h=-h,(null==i||h>i)&&(i=h,r={x:_,y:s}),null!=e&&i>=e)return{x:_,y:s,g:INF}}return{...r,g:i}}}
//# sourceMappingURL=index.8172a1b1.js.map
